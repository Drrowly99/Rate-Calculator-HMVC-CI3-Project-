<div class="content">
  <div class="grid gap-4 grid-cols-2 px-5 py-3 h-full">

      <input type="text" name="gbp" value="5" id="gbp" class="hidden">
      <input type="text" name="eur" value="5" id="eur" class="hidden">
      <input type="text" name="inr" value="5" id="inr" class="hidden ">
      <input type="text" name="cad" value="5" id="cad" class="hidden ">


  <div class="justify-content align-center h-56">
      <div class="w3-white  shadow-md shadow-gray-100/20  rounded-xl h-56" >
        <div class="grid place-items-center font-sans h-10 align-middle">
            <p>USD/GBP</p>
        </div>

        <div class="mb-3 flex justify-center items-center mx-auto w-full bg-white">
          <div class="py-2 w-12 border text-center bg-blue-50"><i class="fas fa-dollar-sign"></i></div><input data-id = "gbp" class="input-usd gbp-usd w-1/2 border border-gray-300  appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="USD" value=''> 
        </div>

        <div class=" flex justify-center mb-3 items-center mx-auto w-full bg-white">
        <div class="py-2 w-12 border text-center bg-blue-50"><i class=" fas fa-flag-usa"></i></div><input data-id = "gbp" class="input-new gbp w-1/2 border border-gray-300 appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="GBP" value=''> 
        </div>
        <div class="flex justify-center space-x-5">

        <button class="w-1/2 relative rounded-lg border-0 shadow-lg font-light shadow-blue-200/60  py-2 px-4 text-white bg-blue-500 hover:bg-blue-700 ">
            Add Rate
          </button>
        </div>
    
          
      </div>
    </div>

    <div class="justify-content align-center h-56">
      <div class="w3-white  shadow-md shadow-gray-100/20  rounded-xl h-56" >
        <div class="grid place-items-center font-sans h-10 align-middle">
            <p>USD/CAD</p>
        </div>

        <div class="mb-3 flex justify-center items-center mx-auto w-full bg-white">
          <div class="py-2 w-12 border text-center bg-blue-50"><i class="fas fa-dollar-sign"></i></div><input data-id = "cad" class="input-usd cad-usd w-1/2 border border-gray-300  appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="USD" value=''> 
        </div>

        <div class=" flex justify-center mb-3 items-center mx-auto w-full bg-white">
        <div class="py-2 w-12 border text-center bg-blue-50"><i class=" fas fa-flag-usa"></i></div><input data-id = "cad" class="input-new cad w-1/2 border border-gray-300 appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="CAD" value=''> 
        </div>
        <div class="flex justify-center space-x-5">

          <button class="w-1/2 relative rounded-lg border-0 shadow-lg font-light shadow-blue-200/60  py-2 px-4 text-white bg-blue-500 hover:bg-blue-700 ">
            Add Rate
          </button>
        </div>
    
          
      </div>
    </div>

    <div class="justify-content align-center h-56">
      <div class="w3-white  shadow-md shadow-gray-100/20  rounded-xl h-56" >
        <div class="grid place-items-center font-sans h-10 align-middle">
            <p>USD/EUR</p>
        </div>

        <div class="mb-3 flex justify-center items-center mx-auto w-full bg-white">
          <div class="py-2 w-12 border text-center rounded bg-blue-50"><i class="fas fa-dollar-sign"></i></div><input data-id = "eur" class="input-usd eur-usd w-1/2 border border-gray-300  appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="USD" value=''> 
        </div>

        <div class=" flex justify-center mb-3 items-center mx-auto w-full bg-white">
        <div class="py-2 w-12 border text-center bg-blue-50"><i class=" fas fa-flag-usa"></i></div><input data-id = "eur" class="input-new eur w-1/2 border border-gray-300 appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="EUR" value=''> 
        </div>
        <div class="flex justify-center space-x-5">
  
        <button class="w-1/2 relative rounded-lg border-0 shadow-lg font-light shadow-blue-200/60  py-2 px-4 text-white bg-blue-500 hover:bg-blue-700 ">
            Add Rate
          </button>
        </div>
    
          
      </div>
    </div>

    <div class="justify-content align-center h-56">
      <div class="w3-white shadow-md shadow-gray-100/20   rounded-xl h-56" >
        <div class="grid place-items-center font-sans h-10 align-middle">
            <p>USD/INR</p>
        </div>

        <div class="mb-3 flex justify-center items-center mx-auto w-full bg-white">
          <div class="py-2 w-12 border text-center bg-blue-50"><i class="fas fa-dollar-sign"></i></div><input data-id = "inr" class="input-usd inr-usd w-1/2 border border-gray-300  appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="USD" value=''> 
        </div>

        <div class=" flex justify-center mb-3 items-center mx-auto w-full bg-white">
          <div class="py-2 w-12 border text-center bg-blue-50"><i class=" fas fa-flag-usa"></i></div><input  data-id = "inr" class="input-new inr w-1/2 border border-gray-300 appearance-none rounded py-2.5 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="INR" value=''> 
        </div>
        <div class="flex justify-center space-x-5">

        <button class="w-1/2 relative rounded-lg border-0 shadow-lg font-light shadow-blue-200/60  py-2 px-4 text-white bg-blue-500 hover:bg-blue-700 ">
            Add Rate
          </button>
        </div>
    
          
      </div>
    </div>

   

  </div>

</div>
<!-- JQUERY SCRIPT -->
<script src="<?php echo base_url()?>assets/plugins/jquery/jquery.min.js"></script>
<script>

  $('.input-new').on('input', function() {
    var val = $(this).val();
    let identity = $(this).data('id')
    let mark = 'new'
    let usd = $(`.${identity}-usd`).val();
    // console.log(val);
    // console.log('usd'+usd);
    getRate(val, mark, identity, usd)
    // data-code = "${e['code']}"  
  });

  $('.input-usd').on('input', function() {
    
    var val = $(this).val();
    let identity = $(this).data('id')
    let mark = 'usd'
    let _new = $(`.${identity}`).val();
    // console.log(`val:${val}`);
    // console.log(`new:${_new}`);
    getRate(val, mark, identity, _new)
    // data-code = "${e['code']}"  
  });

  getRate = (val, mark, identity, val2) => {
    $.ajax({
      url:  `<?php echo base_url() ?>api/${identity}`,
      method: 'get',
      dataType: 'json',
      beforeSend: function()
      {
        // console.log('val 2 is:' + val2)
      },
      success: function(rate)
      {
        // console.log(rate)
        doMath(rate, mark, val, identity)
      }
    })
  }

  doMath = (rate, mark, val, identity) => {

    if(mark == 'usd'){
      $(`.${identity}`).val(val * rate)
      console.log('rate:'+ val * rate)
      console.log('OTHER:'+ val )
      console.log('vs:'+ rate )
      console.log('vs:'+ identity )
    }else{
      $(`.${identity}-usd`).val(val * rate)
      console.log('rate:'+ val / rate)
      console.log('OTHER:'+ val )
      console.log(`.${identity}-${mark}`)
      console.log('vs:'+ identity )
    }

  }

  update = (val, identity) => {
    $.ajax({
      url:  '<?php echo base_url() ?>api/eur',
      method: 'get',
      dataType: 'json',
      beforeSend: function()
      {

      },
      success: function(data)
      {
        console.log(data)
      }
    })
  } 

  loadRate = () => {
    $.ajax({
      url:  `<?php echo base_url() ?>api/loadRate`,
      method: 'get',
      dataType: 'json',
      beforeSend: function()
      {
        // console.log('val 2 is:' + val2)
      },
      success: function(rate)
      {
        // console.log(rate)
        $('#gbp').val(rate['gbp']);
        $('#cad').val(rate['cad']);
        $('#inr').val(rate['inr']);
        $('#eur').val(rate['eur']);

      }
    })
  }
  

  loadRate()
  setInterval(()=>{
    loadRate()
  }, 5000)


  setInit = () => {
    setTimeout(function(){
      $('.input-usd').val(1)
      $('.inr').val($('#inr').val())
      $('.eur').val($('#eur').val())
      $('.cad').val($('#cad').val())
      $('.gbp').val($('#gbp').val())

    },3000)
  }

  setInit()

  
  $('input').on('keydown', function(e) {
    if( $(this).val() < 1){
      $('.input-usd').val(1)
      $('.inr').val($('#inr').val())
      $('.eur').val($('#eur').val())
      $('.cad').val($('#cad').val())
      $('.gbp').val($('#gbp').val())
      }
  })
</script>